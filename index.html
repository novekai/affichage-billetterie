<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord - Allocation Billetterie</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="header-left">
                <h1>üìä Tableau de Bord - Allocation Billetterie</h1>
            </div>
            <div class="header-actions">
                <span id="lastUpdate" class="last-update"></span>
                <button id="toggleHistoryBtn" class="btn-history">üìÇ Historique</button>
            </div>
        </div>

        <div class="filters">
            <div class="filter-group">
                <label for="filterVille">Ville:</label>
                <select id="filterVille">
                    <option value="">Toutes les villes</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="filterDateStart">Date d√©but:</label>
                <input type="date" id="filterDateStart" class="date-input">
            </div>
            <div class="filter-group">
                <label for="filterDateEnd">Date fin:</label>
                <input type="date" id="filterDateEnd" class="date-input">
            </div>
            <button id="btnReset" class="btn-reset-icon" title="R√©initialiser les filtres">‚Ü∫</button>
        </div>

        <div id="historySidebar" class="sidebar">
            <div class="sidebar-header">
                <h3>Historique & Sauvegardes</h3>
                <button id="closeSidebarBtn" class="close-btn">&times;</button>
            </div>
            <div class="sidebar-content">
                <div class="sidebar-section">
                    <h4>Sauvegarder l'√©tat actuel</h4>
                    <button id="saveSnapshotBtn" class="btn-action btn-save">üíæ Enregistrer maintenant</button>
                    <p class="sidebar-info">Cr√©e un instantan√© des donn√©es actuelles dans Airtable.</p>
                </div>

                <div class="sidebar-separator"></div>

                <div class="sidebar-section">
                    <h4>R√©cup√©rer une version</h4>
                    <p class="sidebar-info">Choisissez une date pour restaurer l'affichage correspondant.</p>
                    <div class="sidebar-input-group">
                        <label for="historyDate">Date de l'instantan√© :</label>
                        <input type="date" id="historyDate" class="sidebar-input">
                    </div>
                    <button id="loadHistoryBtn" class="btn-action btn-load">üì• R√©cup√©rer l'affichage</button>
                    <div id="historyStatus" class="status-msg"></div>
                </div>
            </div>
        </div>
        <div id="sidebarOverlay" class="sidebar-overlay"></div>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Chargement des donn√©es depuis Airtable...</p>
        </div>

        <div id="error" class="error" style="display: none;">
            <p>‚ö†Ô∏è Erreur de chargement des donn√©es. Veuillez v√©rifier votre configuration Airtable.</p>
        </div>

        <div class="table-container" id="tableContainer" style="display: none;">
            <table id="dataTable">
                <thead>
                    <tr id="headerRow1" class="header-level-1">
                        <th rowspan="3" class="th-main th-sticky">Date</th>
                        <th rowspan="3" class="th-main th-sticky">Ville</th>
                        <th colspan="9" class="th-category th-or">Cat√©gorie Or</th>
                        <th colspan="9" class="th-category th-platinium">Cat√©gorie Platinium</th>
                        <th colspan="9" class="th-category th-argent">Cat√©gorie Argent</th>
                        <th colspan="9" class="th-category th-total">TOTAL</th>
                        <th rowspan="3" class="th-main th-remplissage">Taux de remplissage</th>
                    </tr>
                    <tr id="headerRow2" class="header-level-2">
                        <th colspan="2" class="th-sub th-or">Fever</th>
                        <th colspan="2" class="th-sub th-or">Regiondo</th>
                        <th colspan="2" class="th-sub th-or">OT</th>
                        <th colspan="2" class="th-sub th-or">Total</th>
                        <th rowspan="2" class="th-sub th-or th-delta">Delta</th>
                        <th colspan="2" class="th-sub th-platinium">Fever</th>
                        <th colspan="2" class="th-sub th-platinium">Regiondo</th>
                        <th colspan="2" class="th-sub th-platinium">OT</th>
                        <th colspan="2" class="th-sub th-platinium">Total</th>
                        <th rowspan="2" class="th-sub th-platinium th-delta">Delta</th>
                        <th colspan="2" class="th-sub th-argent">Fever</th>
                        <th colspan="2" class="th-sub th-argent">Regiondo</th>
                        <th colspan="2" class="th-sub th-argent">OT</th>
                        <th colspan="2" class="th-sub th-argent">Total</th>
                        <th rowspan="2" class="th-sub th-argent th-delta">Delta</th>
                        <th colspan="2" class="th-sub th-total">Fever</th>
                        <th colspan="2" class="th-sub th-total">Regiondo</th>
                        <th colspan="2" class="th-sub th-total">OT</th>
                        <th colspan="2" class="th-sub th-total">Total</th>
                        <th rowspan="2" class="th-sub th-total th-delta">Delta</th>
                    </tr>
                    <tr id="headerRow3" class="header-level-3">
                        <th class="th-col th-or">Ventes</th>
                        <th class="th-col th-or">Quota</th>
                        <th class="th-col th-or">Ventes</th>
                        <th class="th-col th-or">Quota</th>
                        <th class="th-col th-or">Ventes</th>
                        <th class="th-col th-or">Quota</th>
                        <th class="th-col th-or">Ventes</th>
                        <th class="th-col th-or">Quota</th>
                        <th class="th-col th-platinium">Ventes</th>
                        <th class="th-col th-platinium">Quota</th>
                        <th class="th-col th-platinium">Ventes</th>
                        <th class="th-col th-platinium">Quota</th>
                        <th class="th-col th-platinium">Ventes</th>
                        <th class="th-col th-platinium">Quota</th>
                        <th class="th-col th-platinium">Ventes</th>
                        <th class="th-col th-platinium">Quota</th>
                        <th class="th-col th-argent">Ventes</th>
                        <th class="th-col th-argent">Quota</th>
                        <th class="th-col th-argent">Ventes</th>
                        <th class="th-col th-argent">Quota</th>
                        <th class="th-col th-argent">Ventes</th>
                        <th class="th-col th-argent">Quota</th>
                        <th class="th-col th-argent">Ventes</th>
                        <th class="th-col th-argent">Quota</th>
                        <th class="th-col th-total">Ventes</th>
                        <th class="th-col th-total">%</th>
                        <th class="th-col th-total">Ventes</th>
                        <th class="th-col th-total">%</th>
                        <th class="th-col th-total">Ventes</th>
                        <th class="th-col th-total">%</th>
                        <th class="th-col th-total">Ventes</th>
                        <th class="th-col th-total">Quota</th>
                    </tr>
                </thead>
                <tbody id="tableBody"></tbody>
            </table>
        </div>

        <script src="config.js"></script>
        <script src="app.js"></script>
</body>

</html>